<!DOCTYPE HTML>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>ACM template | Wiki</title>
  <meta name="author" content="Tianshu Wang">
  
  <meta name="description" content="Tianshu Wang&#39;s Personal Wiki Page">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="ACM template"/>
  <meta property="og:site_name" content="Wiki"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="Wiki" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  

</head>

<body id="body" data-spy="scroll" data-target=".toc">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/">Wiki</a><span class="split"></span><span class="title">ACM template</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2017-08-26</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  <div class="col-xs-12 col-sm-3 col-md-3 toc"> 
	<!-- toc -->
<script type="text/javascript">
		jQuery(document).ready(function() {
 		   generateWikiTOC('.note', '.toc',  2 , 2 );
		});
</script>
  </div><!-- col-md-3 -->
  
  

  
  <div class="col-xs-12 col-sm-9 col-md-9 note">
	

	  <!-- content -->
	  <h2 id="tips">Tips</h2>
<ol style="list-style-type: decimal">
<li>pow 返回浮点数可能会导致误差，慎用！！！自己写。</li>
<li>样例数用 long long 可能会 TLE</li>
<li>多组数据记得初始化</li>
<li>小心过程量 overflow</li>
<li>Type convertions</li>
<li>在取余的情况下，要避免减法运算的结果出现负数 (…+ MOD) % MOD;</li>
<li>fill 注意初始范围为从 1 到 n 的情况</li>
<li>c++11: long long int abs (long long int n);</li>
<li>字符串多输出 ‘’</li>
<li>输入读取判断其中一个为零</li>
<li>搜索 flag 标记可能要加上方案数</li>
<li>数据范围特别大时考虑不可能情况</li>
<li>SegmentTree 开大点以防 RE （1e5 -&gt; 1 &lt;&lt; 17)</li>
<li>滚动数组未全部清零</li>
</ol>
<hr>
<h2 id="basic-algorithm">Basic Algorithm</h2>
<h3 id="sort">Sort</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Bubble Sort</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N - i - <span class="number">1</span>; j++)</div><div class="line">        <span class="keyword">if</span> (A[j] &gt; A[j + <span class="number">1</span>]) swap(A[j], A[j + <span class="number">1</span>]);</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Insertion Sort</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</div><div class="line">    <span class="keyword">int</span> tmp = A[i], j;</div><div class="line">    <span class="keyword">for</span> (j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span> &amp;&amp; A[j] &gt; tmp; j--)</div><div class="line">        A[j + <span class="number">1</span>] = A[j];</div><div class="line">    A[++j] = tmp;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Selection Sort</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; N; j++)</div><div class="line">        <span class="keyword">if</span> (A[i] &gt; A[j]) swap(A[i], A[j])</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Merge Sort</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge_sort</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (l + <span class="number">1</span> &gt;= r) <span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">int</span> mid = (l + r) / <span class="number">2</span>;</div><div class="line">    merge_sort(A, l, mid);</div><div class="line">    merge_sort(A, mid, r);</div><div class="line">    <span class="keyword">int</span> i, j, k;</div><div class="line">    i = l; j = mid; k = l;</div><div class="line">    <span class="keyword">while</span> (i &lt; mid &amp;&amp; j &lt; r) &#123;</div><div class="line">        <span class="keyword">if</span> (A[i] &lt;= A[j]) B[k++] = A[i++];</div><div class="line">        <span class="keyword">else</span> B[k++] = A[j++];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span> (i &lt; mid) &#123;</div><div class="line">        B[k++] = A[i++];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span> (j &lt; r) &#123;</div><div class="line">        B[k++] = A[j++];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; i++)</div><div class="line">        A[i] = B[i];</div><div class="line">    <span class="keyword">return</span> ;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Quick Sort</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">quicksort</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> i = l, j = r, mid = A[(r - l) / <span class="number">2</span> + l];</div><div class="line">    <span class="keyword">while</span> (i &lt;= j) &#123;</div><div class="line">        <span class="keyword">while</span> (A[i] &lt; mid) i++;</div><div class="line">        <span class="keyword">while</span> (A[j] &gt; mid) j--;</div><div class="line">        <span class="keyword">if</span> (i &lt;= j) &#123;</div><div class="line">            swap(A[i], A[j]);</div><div class="line">            ++i; --j;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (i &lt; r) quicksort(A, i, r);</div><div class="line">    <span class="keyword">if</span> (l &lt; j) quicksort(A, l, j);</div><div class="line">    <span class="keyword">return</span> ;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Heap Sort（见堆的内容）</li>
</ul>
<h3 id="dp">DP</h3>
<h4 id="lis">LIS</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> A[MAX_N];</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="title">lis</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> dp[MAX_N];</div><div class="line">    fill(dp, dp + n, INF);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</div><div class="line">        *lower_bound(dp, dp + n, A[i]) = A[i];<span class="comment">// lds: -A[i]; ln: upper_bound</span></div><div class="line">    <span class="keyword">return</span> lower_bound(dp, dp + n, INF) - dp;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="knapsack-problem">Knapsack Problem</h4>
<ul>
<li>0/1 背包</li>
</ul>
<p><span class="math display">\[f[i, j] = max(f[i - 1, j], f[i - 1, j - w[i]] + v[i])\]</span></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = W; j &gt;= w[i]; --j)</div><div class="line">        f[j] = max(f[j - w[i]] + c[i], f[j]);</div></pre></td></tr></table></figure>
<ul>
<li>完全背包</li>
</ul>
<p><span class="math display">\[f[i, j] = max(f[i - 1, j], f[i, j - w[i]] + j[i])\]</span></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = w[i]; j &lt;= W; ++j)</div><div class="line">        f[j] = max(f[j - w[i]] + c[i], f[v]);</div></pre></td></tr></table></figure>
<p>注意循环顺序的不同背后思路。</p>
<ul>
<li>一个简单的优化：若两件物品 i、j 满足 <span class="math inline">\(w[i] ≤ w[j]\)</span> 且 <span class="math inline">\(c[i] ≥ c[j]\)</span>，则将物品 j 去掉，不用考虑。</li>
<li>转化为 01 背包问题求解：
<ul>
<li>第 i 种物品转化为 <span class="math inline">\(\frac{V}{w[i]}\)</span> 件费用于价值均不变的物品。</li>
<li>第 i 种物品拆成费用为 <span class="math inline">\(w[i] * 2^k\)</span>，价值为 <span class="math inline">\(c[i] * 2^k\)</span> 的若干件物品其中 k 满足 <span class="math inline">\(w[i] * 2^k &lt; V\)</span></li>
</ul></li>
<li>多重背包</li>
</ul>
<p><span class="math display">\[f[i, j] = max(f[i - 1, j - w[i] * k] + v[i] * k | 0 &lt;= k &lt;= m[i])\]</span></p>
<ul>
<li>优化：转化为 01 背包问题
<ul>
<li>将第 i 件物品分成若干件物品，每件物品的系数分别为：<span class="math inline">\(1,2,4,\ldots,2^{(k - 1)},n[i]-2^k\)</span></li>
<li>根据 w，v 范围改变 DP 对象，可以考虑针对不同价值计算最小的重量。（ <span class="math inline">\(f[i][j]\)</span>，其中 j 代表价值总和）</li>
</ul></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</div><div class="line">    <span class="keyword">int</span> num = m[i];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; num &gt; <span class="number">0</span>; k &lt;&lt;= <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">int</span> mul = min(k, num);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = W; j &gt;= w[i] * mul; --j) &#123;</div><div class="line">            f[j] = max(f[j - w[i] * mul] + v[i] * mul, f[j]);</div><div class="line">        &#125;</div><div class="line">        num -= mul;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>混合三种背包</li>
</ul>
<p>  弄清楚上面三种背包后分情况就好</p>
<ul>
<li><p>超大背包</p>
<ul>
<li><span class="math inline">\(1 \leq n \leq 40\)</span>，<span class="math inline">\(1 \leq w_i, v_i \leq 10^{15}\)</span>, <span class="math inline">\(1 \leq W \leq 10^{15}\)</span></li>
</ul></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> n;</div><div class="line">ll w[MAX_N], v[MAX_N], W;</div><div class="line">Pll ps[<span class="number">1</span> &lt;&lt; (MAX_N / <span class="number">2</span>)]; <span class="comment">// (w, v);</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n2 = n / <span class="number">2</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1</span> &lt;&lt; n2; ++i) &#123;</div><div class="line">        ll sw = <span class="number">0</span>, sv = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n2; ++j)</div><div class="line">            <span class="keyword">if</span> (i &gt;&gt; j &amp; <span class="number">1</span>) &#123;</div><div class="line">                sw += w[j];</div><div class="line">                sv += v[j];</div><div class="line">            &#125;</div><div class="line">        ps[i] = Pll(sw, sv);</div><div class="line">    &#125;</div><div class="line">    sort(ps, ps + (<span class="number">1</span> &lt;&lt; n2));</div><div class="line">    <span class="keyword">int</span> m = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">1</span> &lt;&lt; n2; ++i)</div><div class="line">        <span class="keyword">if</span> (ps[m - <span class="number">1</span>].second &lt; ps[i].second)</div><div class="line">            ps[m++] = ps[i];</div><div class="line"></div><div class="line">    ll res = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1</span> &lt;&lt; (n - n2); ++i) &#123;</div><div class="line">        ll sw = <span class="number">0</span>, sv = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n - n2; ++j)</div><div class="line">            <span class="keyword">if</span> (i &gt;&gt; j &amp; <span class="number">1</span>) &#123;</div><div class="line">                sw += w[n2 + j];</div><div class="line">                sv += v[n2 + j];</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">if</span> (sw &lt;= W) &#123;</div><div class="line">            ll tv = (lower_bound(ps, ps + m, make_pair(W - sw, INF)) - <span class="number">1</span>)-&gt;second;</div><div class="line">            res = max(res, sv + tv);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>二维费用背包</li>
</ul>
<p><span class="math display">\[f[i, j, k] = max(f[i - 1, j, k], f[i - 1, j - a[i], k - b[i]] + c[i])\]</span></p>
<p>二维费用可由最多取 m 件等方式隐蔽给出。</p>
<ul>
<li>分组背包</li>
</ul>
<p><span class="math display">\[f[k, j] = max(f[k - 1, j], f[k - 1, j - w[i]] + v[i]| i \in K)\]</span></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; K; ++k)</div><div class="line">    <span class="keyword">for</span> (j = W; j &gt;= <span class="number">0</span>; --j)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m[k]; ++i)</div><div class="line">            f[j] = max(f[j - w[i]] + v[i], f[j]);</div></pre></td></tr></table></figure>
<p>显然可以对每组中物品应用完全背包中“一个简单有效的优化”</p>
<ul>
<li>有依赖背包</li>
</ul>
<p>由 NOIP2006 金明的预算方案引申，对每个附件先做一个 01 背包，再与组件得到一个 <span class="math inline">\(V - w[i] + 1\)</span> 个物品组。 更一般问题，依赖关系由「森林」形式给出，涉及到树形 DP 以及泛化物品，这里不表。</p>
<ul>
<li>背包问题方案总数</li>
</ul>
<p><span class="math display">\[f[i, j] = sum(f[i - 1, j], f[i - 1, j - w[i]] + v[i]),f[0, 0] = 0\]</span></p>
<blockquote>
<blockquote>
<p>更多内容详见「背包九讲」</p>
</blockquote>
</blockquote>
<h4 id="maximum-subarray-sum">Maximum Subarray Sum</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">max_subarray_sum</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> res, cur;</div><div class="line">    <span class="keyword">if</span> (!A || n &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    res = cur = a[<span class="number">0</span>];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">        <span class="keyword">if</span> (cur &lt; <span class="number">0</span>) cur = a[i];</div><div class="line">        <span class="keyword">else</span> cur += a[i];</div><div class="line">        res = max(cur, res);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="set">Set</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 子集枚举</span></div><div class="line"><span class="keyword">int</span> sub = sup;</div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line">    sub = (sub - <span class="number">1</span>) &amp; sup;</div><div class="line">&#125; <span class="keyword">while</span> (sub != sup); <span class="comment">// -1 &amp; sup = sup;</span></div><div class="line"></div><div class="line"><span class="comment">// 势为 k 的集合枚举</span></div><div class="line"><span class="keyword">int</span> comb = (<span class="number">1</span> &lt;&lt; k) - <span class="number">1</span>;</div><div class="line"><span class="keyword">while</span> (comb &lt; <span class="number">1</span> &lt;&lt; n) &#123;</div><div class="line">    <span class="keyword">int</span> x = comb &amp; -comb, y = comb + x;</div><div class="line">    comb = ((comb &amp; ~y) / x &gt;&gt; <span class="number">1</span>) | y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 排列组合</span></div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line"></div><div class="line">&#125; <span class="keyword">while</span> (next_permutation(A, A + N)); <span class="comment">// prev_permutation</span></div></pre></td></tr></table></figure>
<h3 id="bit-operation">Bit operation</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> __builtin_ffs (<span class="keyword">unsigned</span> <span class="keyword">int</span> x)</div><div class="line"><span class="comment">//返回x的最后一位1的是从后向前第几位，比如7368（1110011001000）返回4。</span></div><div class="line"><span class="keyword">int</span> __builtin_clz (<span class="keyword">unsigned</span> <span class="keyword">int</span> x)</div><div class="line"><span class="comment">// 返回前导的0的个数。</span></div><div class="line"><span class="keyword">int</span> __builtin_ctz (<span class="keyword">unsigned</span> <span class="keyword">int</span> x)</div><div class="line"><span class="comment">// 返回后面的0个个数，和__builtiin_clz相对。</span></div><div class="line"><span class="keyword">int</span> __builtin_popcount (<span class="keyword">unsigned</span> <span class="keyword">int</span> x)</div><div class="line"><span class="comment">// 返回二进制表示中1的个数。</span></div><div class="line"><span class="keyword">int</span> __builtin_parity (<span class="keyword">unsigned</span> <span class="keyword">int</span> x)</div><div class="line"><span class="comment">// 返回x的奇偶校验位，也就是x的1的个数模2的结果。</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="data-structure">Data Structure</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Heap</span></div><div class="line"><span class="keyword">int</span> heap[MAX_N], sz = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> i = sz++;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (i &gt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">int</span> p = (i - <span class="number">1</span>) / <span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span> (heap[p] &lt;= x) <span class="keyword">break</span>;</div><div class="line">        heap[i] = heap[p];</div><div class="line">        i = p;</div><div class="line">    &#125;</div><div class="line">    heap[i] = x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> ret = heap[<span class="number">0</span>];</div><div class="line">    <span class="keyword">int</span> x = heap[--sz];</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (i * <span class="number">2</span> + <span class="number">1</span> &lt; sz) &#123;</div><div class="line">        <span class="keyword">int</span> a = i * <span class="number">2</span> + <span class="number">1</span>, b = i * <span class="number">2</span> + <span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span> (b &lt; sz &amp;&amp; heap[b] &lt; heap[a]) a = b;</div><div class="line">        <span class="keyword">if</span> (heap[a] &gt;= x) <span class="keyword">break</span>;</div><div class="line">        heap[i] = heap[a];</div><div class="line">        i = a;</div><div class="line">    &#125;</div><div class="line">    heap[i] = x;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Binary Search Tree</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> val;</div><div class="line">    node *lch, rch;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function">node *<span class="title">insert</span><span class="params">(node *p, <span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (p == <span class="literal">NULL</span>) &#123;</div><div class="line">        node *q = <span class="keyword">new</span> node;</div><div class="line">        q-&gt;val = x;</div><div class="line">        q-&gt;lch = q-&gt;rch = <span class="literal">NULL</span>;</div><div class="line">        <span class="keyword">return</span> q;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">if</span> (x &lt; p-&gt;val) p-&gt;lch = insert(p-&gt;lch, x);</div><div class="line">        <span class="keyword">else</span> p-&gt;rch = insert(p-&gt;rch, x);</div><div class="line">        <span class="keyword">return</span> p;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(node *p, <span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (p == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (x == p-&gt;val) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (x &lt; p-&gt;val) <span class="keyword">return</span> find(p-&gt;lch, x);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> find(p-&gt;rch, x);</div><div class="line">&#125;</div><div class="line"><span class="function">node *<span class="title">remove</span><span class="params">(node *p, <span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (p == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (x &lt; p-&gt;val) p-&gt;lch = remove(p-&gt;lch, x);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (x &gt; p-&gt;val) p-&gt;rch = remove(p-&gt;rch, x);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (p-&gt;lch == <span class="literal">NULL</span>) &#123;</div><div class="line">        node *q = p-&gt;rch;</div><div class="line">        <span class="keyword">delete</span> p;</div><div class="line">        <span class="keyword">return</span> q;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (p-&gt;lch-&gt;rch == <span class="literal">NULL</span>) &#123;</div><div class="line">        node *q = p-&gt;lch;</div><div class="line">        q-&gt;rch = p-&gt;rch;</div><div class="line">        <span class="keyword">delete</span> p;</div><div class="line">        <span class="keyword">return</span> q;</div><div class="line">    &#125;  <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// 把左儿子子孙中最大的节点提到需要删除的节点上</span></div><div class="line">        node *q;</div><div class="line">        <span class="keyword">for</span> (q = p-&gt;lch; q-&gt;rch-&gt;rch != <span class="literal">NULL</span>; q = q-&gt;rch);</div><div class="line">        node *r = q-&gt;rch;</div><div class="line">        q-&gt;rch = r-&gt;lch;</div><div class="line">        r-&gt;lch = p-&gt;lch;</div><div class="line">        r-&gt;rch = p-&gt;rch;</div><div class="line">        <span class="keyword">delete</span> p;</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> p;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Union-find Set</span></div><div class="line"><span class="keyword">int</span> par[MAX_N];</div><div class="line"><span class="keyword">int</span> rnk[MAX_N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">        par[i] = i;</div><div class="line">        rnk[i] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> par[x] == x? x : par[x] = find(par[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">same</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> find(x) == find(y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    x = find(x);</div><div class="line">    y = find(y);</div><div class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span> (rnk[x] &lt; rnk[y]) &#123;</div><div class="line">        par[x] = y;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        par[y] = x;</div><div class="line">        <span class="keyword">if</span> (rnk[x] == rnk[y]) rnk[x]++;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>当然，更快捷简单的做法，是使用 C++ 的 container。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Segment Tree</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_N = <span class="number">1</span> &lt;&lt; <span class="number">17</span>;</div><div class="line"><span class="keyword">int</span> n, dat[<span class="number">2</span> * MAX_N - <span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> _n)</span> </span>&#123;</div><div class="line">    n = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (n &lt; _n) n &lt;&lt;= <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span> * n - <span class="number">1</span>; ++i)</div><div class="line">        dat[i] = INF;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> a)</span> </span>&#123;</div><div class="line">    k += n - <span class="number">1</span>;</div><div class="line">    dat[k] = a;</div><div class="line">    <span class="keyword">while</span> (k &gt; <span class="number">0</span>) &#123;</div><div class="line">        k = (k - <span class="number">1</span>) / <span class="number">2</span>;</div><div class="line">        dat[k] = min(dat[<span class="number">2</span> * k + <span class="number">1</span>], dat[<span class="number">2</span> * k + <span class="number">2</span>]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// query [a, b), index k in [l, r)</span></div><div class="line"><span class="comment">// query(a, b, 0, 0, n)</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (r &lt;= a || b &lt;= l) <span class="keyword">return</span> INF;</div><div class="line">    <span class="keyword">if</span> (a &lt;= l &amp;&amp; r &lt;= b) <span class="keyword">return</span> dat[k];</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">int</span> v1 = query(a, b, k * <span class="number">2</span> + <span class="number">1</span>, l, (l + r) / <span class="number">2</span>);</div><div class="line">        <span class="keyword">int</span> v2 = query(a, b, k * <span class="number">2</span> + <span class="number">2</span>, (l + r) / <span class="number">2</span>, r);</div><div class="line">        <span class="keyword">return</span> min(v1, v2);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// RMQ</span></div><div class="line"><span class="keyword">int</span> n, dat[<span class="number">2</span> * MAX_N - <span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> _n)</span> </span>&#123;</div><div class="line">    n = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (n &lt; _n) n &lt;&lt;= <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span> * n - <span class="number">1</span>; ++i)</div><div class="line">        dat[i] = INF;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> a)</span> </span>&#123;</div><div class="line">    k += n - <span class="number">1</span>;</div><div class="line">    dat[k] = a;</div><div class="line">    <span class="keyword">while</span> (k &gt; <span class="number">0</span>) &#123;</div><div class="line">        k = (k - <span class="number">1</span>) / <span class="number">2</span>;</div><div class="line">        dat[k] = min(dat[<span class="number">2</span> * k + <span class="number">1</span>], dat[<span class="number">2</span> * k + <span class="number">2</span>]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// query [a, b), index k in [l, r)</span></div><div class="line"><span class="comment">// query(a, b, 0, 0, n)</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (r &lt;= a || b &lt;= l) <span class="keyword">return</span> INF;</div><div class="line">    <span class="keyword">if</span> (a &lt;= l &amp;&amp; r &lt;= b) <span class="keyword">return</span> dat[k];</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">int</span> v1 = query(a, b, k * <span class="number">2</span> + <span class="number">1</span>, l, (l + r) / <span class="number">2</span>);</div><div class="line">        <span class="keyword">int</span> v2 = query(a, b, k * <span class="number">2</span> + <span class="number">2</span>, (l + r) / <span class="number">2</span>, r);</div><div class="line">        <span class="keyword">return</span> min(v1, v2);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Sparse Table</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_N = <span class="number">1e5</span> + <span class="number">10</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_K = <span class="number">31</span> - __builtin_clz(MAX_N);</div><div class="line"></div><div class="line"><span class="keyword">int</span> n, ST[MAX_N][MAX_K + <span class="number">1</span>], A[MAX_N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">        ST[i][<span class="number">0</span>] = A[i];</div><div class="line">    <span class="keyword">int</span> k = <span class="number">31</span> - __builtin_clz(N);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= k; ++j)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N - (<span class="number">1</span> &lt;&lt; j); ++i)</div><div class="line">            ST[i][j] = min(ST[i][j - <span class="number">1</span>], ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> ans = INF, k = <span class="number">31</span> - __builtin_clz(r - l);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = k; j &gt;= <span class="number">0</span>; --j)</div><div class="line">        <span class="keyword">if</span> (l + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= r) &#123;</div><div class="line">            ans = min(ans, ST[l][j]);</div><div class="line">            l += <span class="number">1</span> &lt;&lt; j;</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">RMQ</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> k = <span class="number">31</span> - __builtin_clz(r - l);</div><div class="line">    <span class="keyword">return</span> min(ST[l][k], ST[r - (<span class="number">1</span> &lt;&lt; k)][k]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="graph">Graph</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> from;</div><div class="line">    <span class="keyword">int</span> to, dis;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;edge&gt; G[MAX_V];</div><div class="line"><span class="built_in">vector</span>&lt;edge&gt; es;</div><div class="line"><span class="keyword">bool</span> vis[MAX_V];</div><div class="line"><span class="keyword">int</span> V, E, pre[MAX_V], dist[MAX_V];</div><div class="line"><span class="comment">// int cost[MAX_V][MAX_V];</span></div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Shortest Way</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">    priority_queue&lt;Pii, <span class="built_in">vector</span>&lt;Pii&gt;, greater&lt;Pii&gt; &gt; que;<span class="comment">// fisrt 是最短距离，second 是顶点编号</span></div><div class="line">    fill(dist, dist + V, INF);</div><div class="line">    dist[s] = <span class="number">0</span>; que.push(Pii(<span class="number">0</span>, s));</div><div class="line">    <span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">        Pii p = que.top(); que.pop();</div><div class="line">        <span class="keyword">int</span> v = p.second;</div><div class="line">        <span class="keyword">if</span> (dist[v] &lt; p.first) <span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[v].size(); i++) &#123;</div><div class="line">            edge e = G[v][i];</div><div class="line">            <span class="keyword">if</span> (dist[e.to] &gt; dist[v] + e.dis) &#123;</div><div class="line">                dist[e.to] = dist[v] + e.dis;</div><div class="line">                que.push(Pii(dist[e.to], e.to));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">bellman_ford</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">    fill(dist, dist + V, INF);</div><div class="line">    dist[s] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">        <span class="keyword">bool</span> update = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E; ++i) &#123;</div><div class="line">            edge e = es[i];</div><div class="line">            <span class="keyword">if</span> (dist[e.from] != INF &amp;&amp; dist[e.from] + e.dis &lt; dist[e.to]) &#123;</div><div class="line">                update = <span class="literal">true</span>;</div><div class="line">                dist[e.to] = dist[e.from] + e.dis;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!update) <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find_negative_loop</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">memset</span>(dist, <span class="number">0</span>, <span class="keyword">sizeof</span> dist);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V; ++i)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; E; ++j) &#123;</div><div class="line">            edge e = es[j];</div><div class="line">            <span class="keyword">if</span> (d[e.to] &gt; d[e.from] + e.dis) &#123;</div><div class="line">                d[e.to] = d[e.from] + e.dis;</div><div class="line">                <span class="keyword">if</span> (i == V - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</div><div class="line">    fill(dist, dist + V, INF);</div><div class="line">    fill(vis, vis + V, <span class="literal">false</span>);</div><div class="line">    dist[s] = <span class="number">0</span>; que.push(s); vis[s] = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">        <span class="keyword">int</span> v = que.front(); que.pop();</div><div class="line">        vis[v] = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[v].size(); ++i) &#123;</div><div class="line">            <span class="keyword">int</span> u = G[v][i].to;</div><div class="line">            <span class="keyword">if</span> (dist[u] &gt; dist[v] + G[v][i].dis) &#123;</div><div class="line">                dist[u] = dist[v] + G[v][i].dis;</div><div class="line">                <span class="keyword">if</span> (!vis[u]) &#123;</div><div class="line">                    que.push(u);</div><div class="line">                    vis[u] = <span class="literal">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Spanning Tree</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">prime</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">    fill(dist, dist + V, INF);</span></div><div class="line"><span class="comment">    fill(vis, vis + V, false);</span></div><div class="line"><span class="comment">    dist[0] = 0;</span></div><div class="line"><span class="comment">    int res = 0;</span></div><div class="line"><span class="comment">    while (true) &#123;</span></div><div class="line"><span class="comment">        int v = -1;</span></div><div class="line"><span class="comment">        for (int u = 0; u &lt; V; ++u) &#123;</span></div><div class="line"><span class="comment">            if(!vis[u] &amp;&amp; (v == -1 || dist[u] &lt; dist[v])) v = u;</span></div><div class="line"><span class="comment">        &#125;</span></div><div class="line"><span class="comment">        if (v == -1) break;</span></div><div class="line"><span class="comment">        vis[v] = true;</span></div><div class="line"><span class="comment">        res += dist[v];</span></div><div class="line"><span class="comment">        for (int u = 0; u &lt; V; u++)</span></div><div class="line"><span class="comment">            dist[u] = min(dist[u], cost[v][u]);</span></div><div class="line"><span class="comment">    &#125;</span></div><div class="line"><span class="comment">    //*/</span></div><div class="line">    priority_queue&lt;Pii, <span class="built_in">vector</span>&lt;Pii&gt;, greater&lt;Pii&gt; &gt; que;</div><div class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">    fill(dist, dist + V, INF);</div><div class="line">    fill(vis, vis + V, <span class="literal">false</span>);</div><div class="line">    dist[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">    que.push(Pii(<span class="number">0</span>, <span class="number">0</span>));</div><div class="line">    <span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">        Pii p = que.top(); que.pop();</div><div class="line">        <span class="keyword">int</span> v = p.second;</div><div class="line">        <span class="keyword">if</span> (vis[v] || dist[v] &lt; p.first) <span class="keyword">continue</span>;</div><div class="line">        res += dist[v]; vis[v] = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[v].size(); ++i) &#123;</div><div class="line">            edge e = G[v][i];</div><div class="line">            <span class="keyword">if</span> (dist[e.to] &gt; e.dis) &#123;</div><div class="line">                dist[e.to] = e.dis;</div><div class="line">                que.push(Pii(dist[e.to], e.to));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> edge e1, <span class="keyword">const</span> edge e2)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> e1.dis &lt; e2.dis;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">kruskal</span><span class="params">()</span> </span>&#123;</div><div class="line">    sort(es.begin(), es.end(), cmp);</div><div class="line">    init(V);</div><div class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E; ++i) &#123;</div><div class="line">        edge e = es[i];</div><div class="line">        <span class="keyword">if</span> (!same(e.from, e.to)) &#123;</div><div class="line">            unite(e.from, e.to);</div><div class="line">            res += e.dis;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// SCC</span></div><div class="line"><span class="keyword">int</span> V, cmp[MAX_V];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAX_V], rG[MAX_V], vs;</div><div class="line"><span class="keyword">bool</span> used[MAX_V];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to)</span> </span>&#123;</div><div class="line">    G[from].push_back(to); rG[to].push_back(from);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    used[v] = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[v].size(); ++i)</div><div class="line">        <span class="keyword">if</span> (!used[G[v][i]]) dfs(G[v][i]);</div><div class="line">    vs.push_back(v);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rdfs</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">    used[v] = <span class="literal">true</span>;</div><div class="line">    cmp[v] = k;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rG[v].size(); ++i)</div><div class="line">        <span class="keyword">if</span> (!used[rG[v][i]]) rdfs(rG[v][i], k);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">scc</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">memset</span>(used, <span class="number">0</span>, <span class="keyword">sizeof</span> used);</div><div class="line">    vs.clear();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; ++v)</div><div class="line">        <span class="keyword">if</span> (!used[v]) dfs(v);</div><div class="line">    <span class="built_in">memset</span>(used, <span class="number">0</span>, <span class="keyword">sizeof</span> used);</div><div class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = vs.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</div><div class="line">        <span class="keyword">if</span> (!used[vs[i]]) rdfs(vs[i], k++);</div><div class="line">    <span class="keyword">return</span> k;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Bipartite Matching</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    G[u].push_back(v); G[v].push_back(u);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    used[v] = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)G[v].size(); i++) &#123;</div><div class="line">        <span class="keyword">int</span> u = G[v][i], w = match[u];</div><div class="line">        <span class="keyword">if</span> (w &lt; <span class="number">0</span> || (!used[w] &amp;&amp; dfs(w))) &#123;</div><div class="line">            match[v] = u; match[u] = v;</div><div class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">bipartite_matching</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(match, <span class="number">-1</span>, <span class="keyword">sizeof</span> match);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++)</div><div class="line">        <span class="keyword">if</span> (match[v] &lt; <span class="number">0</span>) &#123;</div><div class="line">            <span class="built_in">memset</span>(used, <span class="literal">false</span>, <span class="keyword">sizeof</span> used);</div><div class="line">            <span class="keyword">if</span> (dfs(v)) ++res;</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Network Flow</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> to, cap, rev;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;edge&gt; G[MAX_V];</div><div class="line"><span class="keyword">int</span> level[MAX_V], iter[MAX_V];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to, <span class="keyword">int</span> cap)</span> </span>&#123;</div><div class="line">    G[from].push_back((edge)&#123;to, cap, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(G[to].size())&#125;);</div><div class="line">    G[to].push_back((edge)&#123;from, <span class="number">0</span>, <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(G[from].size() - <span class="number">1</span>)&#125;);</div><div class="line">&#125;</div><div class="line"><span class="comment">// Ford-Fulkerson</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> t, <span class="keyword">int</span> f)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (v == t) <span class="keyword">return</span> f;</div><div class="line">    flag[v] = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)G[v].size(); i++) &#123;</div><div class="line">        edge &amp;e = G[v][i];</div><div class="line">        <span class="keyword">if</span> (!flag[e.to] &amp;&amp; e.cap &gt; <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">int</span> d = dfs(e.to, t, min(f, e.cap));</div><div class="line">            <span class="keyword">if</span> (d &gt; <span class="number">0</span>) &#123;</div><div class="line">                e.cap -= d;</div><div class="line">                G[e.to][e.rev].cap += d;</div><div class="line">                <span class="keyword">return</span> d;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">max_flow</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(;;) &#123;</div><div class="line">        <span class="built_in">memset</span>(flag, <span class="literal">false</span>, <span class="keyword">sizeof</span> flag);</div><div class="line">        <span class="keyword">int</span> f = dfs(s, t, INF);</div><div class="line">        <span class="keyword">if</span> (!f) <span class="keyword">return</span> flow;</div><div class="line">        flow += f;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// Dinic</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">    <span class="built_in">memset</span>(level, <span class="number">-1</span>, <span class="keyword">sizeof</span>(level));</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</div><div class="line">    level[s] = <span class="number">0</span>; que.push(s);</div><div class="line">    <span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">        <span class="keyword">int</span> v = que.front(); que.pop();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[v].size(); ++i) &#123;</div><div class="line">            edge &amp;e = G[v][i];</div><div class="line">            <span class="keyword">if</span> (e.cap &gt; <span class="number">0</span> &amp;&amp; level[e.to] &lt; <span class="number">0</span>) &#123;</div><div class="line">                level[e.to] = level[v] + <span class="number">1</span>;</div><div class="line">                que.push(e.to);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> t, <span class="keyword">int</span> f)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (v == t) <span class="keyword">return</span> f;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> &amp;i = iter[v]; i &lt; G[v].size(); ++i) &#123;</div><div class="line">        edge &amp;e = G[v][i];</div><div class="line">        <span class="keyword">if</span> (e.cap &gt; <span class="number">0</span> &amp;&amp; level[v] &lt; level[e.to]) &#123;</div><div class="line">            <span class="keyword">int</span> d = dfs(e.to, t, min(f, e.cap));</div><div class="line">            <span class="keyword">if</span> (d &gt; <span class="number">0</span>) &#123;</div><div class="line">                e.cap -= d;</div><div class="line">                G[e.to][e.rev].cap += d;</div><div class="line">                <span class="keyword">return</span> d;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">max_flow</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (;;) &#123;</div><div class="line">        bfs(s);</div><div class="line">        <span class="keyword">if</span> (level[t] &lt; <span class="number">0</span>) <span class="keyword">return</span> flow;</div><div class="line">        <span class="built_in">memset</span>(iter, <span class="number">0</span>, <span class="keyword">sizeof</span> iter);</div><div class="line">        <span class="keyword">int</span> f;</div><div class="line">        <span class="keyword">while</span> ((f = dfs(s, t, INF)) &gt; <span class="number">0</span>) &#123;</div><div class="line">            flow += f;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// min_cost_flow</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to, <span class="keyword">int</span> cap, <span class="keyword">int</span> cost)</span> </span>&#123;</div><div class="line">    G[from].push_back((edge)&#123;to, cap, cost, (<span class="keyword">int</span>)G[to].size()&#125;);</div><div class="line">    G[to].push_back((edge)&#123;from, <span class="number">0</span>, -cost, (<span class="keyword">int</span>)G[from].size() - <span class="number">1</span>&#125;);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">min_cost_flow</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> f)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">    fill(h, h + V, <span class="number">0</span>);</div><div class="line">    <span class="keyword">while</span> (f &gt; <span class="number">0</span>) &#123;</div><div class="line">        priority_queue&lt;Pii, <span class="built_in">vector</span>&lt;Pii&gt;, greater&lt;Pii&gt; &gt; que;</div><div class="line">        fill(dist, dist + V, INF);</div><div class="line">        dist[s] = <span class="number">0</span>; que.push(Pii(<span class="number">0</span>, s));</div><div class="line">        <span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">            Pii p = que.top(); que.pop();</div><div class="line">            <span class="keyword">int</span> v = p.second;</div><div class="line">            <span class="keyword">if</span> (dist[v] &lt; p.first) <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)G[v].size(); i++) &#123;</div><div class="line">                edge &amp;e = G[v][i];</div><div class="line">                <span class="keyword">if</span> (e.cap &gt; <span class="number">0</span> &amp;&amp; dist[e.to] &gt; dist[v] + e.cost + h[v] - h[e.to]) &#123;</div><div class="line">                    dist[e.to] = dist[v] + e.cost + h[v] - h[e.to];</div><div class="line">                    prevv[e.to] = v;</div><div class="line">                    preve[e.to] = i;</div><div class="line">                    que.push(Pii(dist[e.to], e.to));</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (dist[t] == INF) <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++) h[v] += dist[v];</div><div class="line">        <span class="keyword">int</span> d = f;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = t; v != s; v = prevv[v])</div><div class="line">            d = min(d, G[prevv[v]][preve[v]].cap);</div><div class="line">        f -= d;</div><div class="line">        res += d * h[t];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = t; v != s; v = prevv[v]) &#123;</div><div class="line">            edge &amp;e = G[prevv[v]][preve[v]];</div><div class="line">            e.cap -= d;</div><div class="line">            G[v][e.rev].cap += d;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// stoer_wagner 全局最小割</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span> vis);</div><div class="line">    <span class="built_in">memset</span>(wet, <span class="number">0</span>, <span class="keyword">sizeof</span> wet);</div><div class="line">    S = T = <span class="number">-1</span>;</div><div class="line">    <span class="keyword">int</span> imax, tmp;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V; i++) &#123;</div><div class="line">        imax = -INF;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; V; j++)</div><div class="line">            <span class="keyword">if</span> (!cmb[j] &amp;&amp; !vis[j] &amp;&amp; wet[j] &gt; imax) &#123;</div><div class="line">                imax = wet[j];</div><div class="line">                tmp = j;</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">if</span> (T == tmp) <span class="keyword">return</span>;</div><div class="line">        S = T; T = tmp;</div><div class="line">        mc = imax;</div><div class="line">        vis[tmp] = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; V; j++)</div><div class="line">            <span class="keyword">if</span> (!cmb[j] &amp;&amp; !vis[j])</div><div class="line">                wet[j] += G[tmp][j];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">stoer_wagner</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">memset</span>(cmb, <span class="literal">false</span>, <span class="keyword">sizeof</span> cmb);</div><div class="line">    <span class="keyword">int</span> ans = INF;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V - <span class="number">1</span>; i++) &#123;</div><div class="line">        search();</div><div class="line">        ans = min(ans, mc);</div><div class="line">        <span class="keyword">if</span> (ans == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        cmb[T] = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; V; j++)</div><div class="line">            <span class="keyword">if</span> (!cmb[j]) &#123;</div><div class="line">                G[S][j] += G[T][j];</div><div class="line">                G[j][S] += G[j][T];</div><div class="line">            &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// LCA--Doubling</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_LOG_V = <span class="number">32</span> - __builtin_clz(MAX_V);</div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAX_V];</div><div class="line"><span class="keyword">int</span> root, parent[MAX_LOG_V][MAX_V], depth[MAX_V];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> p, <span class="keyword">int</span> d)</span> </span>&#123;</div><div class="line">    parent[<span class="number">0</span>][v] = p;</div><div class="line">    depth[v] = d;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[v].size(); i++)</div><div class="line">        <span class="keyword">if</span> (G[v][i] != p) dfs(G[v][i], v, d + <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> V)</span> </span>&#123;</div><div class="line">    dfs(root, <span class="number">-1</span>, <span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k + <span class="number">1</span> &lt; MAX_LOG_V; k++)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; V; v++)</div><div class="line">            <span class="keyword">if</span> (parent[k][v] &lt; <span class="number">0</span>) parent[k + <span class="number">1</span>][v] = <span class="number">-1</span>;</div><div class="line">            <span class="keyword">else</span> parent[k + <span class="number">1</span>][v] = parent[k][parent[k][v]];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (depth[u] &gt; depth[v]) swap(u, v);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; MAX_LOG_V; k++)</div><div class="line">        <span class="keyword">if</span> ((depth[v] - depth[u]) &gt;&gt; k &amp; <span class="number">1</span>)</div><div class="line">            v = parent[k][v];</div><div class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> u;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = MAX_LOG_V - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--)</div><div class="line">        <span class="keyword">if</span> (parent[k][u] != parent[k][v])</div><div class="line">            u = parent[k][u], v = parent[k][v];</div><div class="line">    <span class="keyword">return</span> parent[<span class="number">0</span>][u];</div><div class="line">&#125;</div><div class="line"><span class="comment">// LCA--RMQ</span></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAX_V];</div><div class="line"><span class="keyword">int</span> root, vs[MAX_V * <span class="number">2</span> - <span class="number">1</span>], depth[MAX_V * <span class="number">2</span> - <span class="number">1</span>], id[MAX_V];</div><div class="line"></div><div class="line"><span class="keyword">int</span> ST[<span class="number">2</span> * MAX_V][MAX_K];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rmq_init</span><span class="params">(<span class="keyword">int</span>* A, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</div><div class="line">        ST[i][<span class="number">0</span>] = i;</div><div class="line">    <span class="keyword">int</span> k = <span class="number">31</span> - __builtin_clz(N);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= k; j++)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N - (<span class="number">1</span> &lt;&lt; j); ++i)</div><div class="line">            <span class="keyword">if</span> (A[ST[i][j - <span class="number">1</span>]] &lt;= A[ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]])</div><div class="line">                ST[i][j] = ST[i][j - <span class="number">1</span>];</div><div class="line">            <span class="keyword">else</span> ST[i][j] = ST[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    <span class="keyword">int</span> k = <span class="number">31</span> - __builtin_clz(r - l);</div><div class="line">    <span class="keyword">return</span> (depth[ST[l][k]] &lt;= depth[ST[r - (<span class="number">1</span> &lt;&lt; k)][k]]) ? ST[l][k] : ST[r - (<span class="number">1</span> &lt;&lt; k)][k];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> p, <span class="keyword">int</span> d, <span class="keyword">int</span> &amp;k)</span> </span>&#123;</div><div class="line">    id[v] = k;</div><div class="line">    vs[k] = v;</div><div class="line">    depth[k++] = d;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[v].size(); i++) &#123;</div><div class="line">        <span class="keyword">if</span> (G[v][i] != p) &#123;</div><div class="line">            dfs(G[v][i], v, d + <span class="number">1</span>, k);</div><div class="line">            vs[k] = v;</div><div class="line">            depth[k++] = d;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> V)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</div><div class="line">    dfs(root, <span class="number">-1</span>, <span class="number">0</span>, k);</div><div class="line">    rmq_init(depth, <span class="number">2</span> * V - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> vs[query(min(id[u], id[v]), max(id[u], id[v]) + <span class="number">1</span>)];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="computational-geometry">Computational Geometry</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1e-8</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123; <span class="keyword">return</span> x &lt; -EPS ? <span class="number">-1</span> : x &gt; EPS ? <span class="number">1</span> : <span class="number">0</span>;&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">add</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">abs</span>(a + b) &lt; EPS * (<span class="built_in">abs</span>(a) + <span class="built_in">abs</span>(b))) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span> a + b;</div><div class="line">&#125;;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    Point(<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>) : x(x), y(y) &#123;&#125;</div><div class="line">    Point <span class="keyword">operator</span> + (Point p) &#123; <span class="keyword">return</span> Point(x + p.x, y + p.y); &#125;</div><div class="line">    Point <span class="keyword">operator</span> - (Point p) &#123; <span class="keyword">return</span> Point(x - p.x, y - p.y); &#125;</div><div class="line">    Point <span class="keyword">operator</span> * (<span class="keyword">double</span> d) &#123; <span class="keyword">return</span> Point(x * d, y * d); &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Point p) &#123;</div><div class="line">        <span class="keyword">return</span> x != p.x? x &lt; p.x : y &lt; p.y;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Point p)</span> </span>&#123; <span class="keyword">return</span> add(x * p.x, y * p.y); &#125;<span class="comment">// 内积</span></div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">det</span><span class="params">(Point p)</span> </span>&#123; <span class="keyword">return</span> add(x * p.y, -y * p.x);&#125;<span class="comment">// 外积</span></div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">on_seg</span><span class="params">(Point p1, Point p2, Point q)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (p1 - q).det(p2 - q) == <span class="number">0</span> &amp;&amp; (p1 - q).dot(p2 - q) &lt;= <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function">Point <span class="title">intersection</span><span class="params">(Point p1, Point p2, Point q1, Point q2)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> p1 + (p2 - p1) * ((q2 - q1).det(q1 - p1) / (q2 - q1).det(p2 - p1));</div><div class="line">&#125;</div><div class="line"><span class="comment">// 凸包</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">convex_hull</span><span class="params">(Point *ps, <span class="keyword">int</span> n, Point *ch)</span> </span>&#123;</div><div class="line">    sort(ps, ps + n);</div><div class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">        <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; (ch[k - <span class="number">1</span>] - ch[k - <span class="number">2</span>]).det(ps[i] - ch[k - <span class="number">1</span>]) &lt;= <span class="number">0</span>) k--;</div><div class="line">        ch[k++] = ps[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">2</span>, t = k; i &gt;= <span class="number">0</span>; --i) &#123;</div><div class="line">        <span class="keyword">while</span> (k &gt; t &amp;&amp; (ch[k - <span class="number">1</span>] - ch[k - <span class="number">2</span>]).det(ps[i] - ch[k - <span class="number">1</span>]) &lt;= <span class="number">0</span>) k--;</div><div class="line">        ch[k++] = ps[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> k - <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Simpson 公式——二次函数近似原函数积分: <span class="math display">\[\int^b_af(x)dx \approx \frac{b - a}6*\left(f(a) + 4f(\frac{a + b}2) + f(b)\right)\]</span></p>
<hr>
<h2 id="math-problem">Math Problem</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// returning count of nk in range [l, r], from Infinity</span></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">mps</span><span class="params">(T l, T r, T k)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> ((r - (r % k + k) % k) - (l + (k - l % k) % k)) / k + <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">gcd</span><span class="params">(T a, T b)</span> </span>&#123;</div><div class="line">    <span class="comment">//return (b)? gcd(b, a  % b) : a;</span></div><div class="line">    <span class="keyword">while</span> (b) &#123; T t = a % b; a = b; b = t; &#125; <span class="keyword">return</span> a;</div><div class="line">&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">lcm</span><span class="params">(T a, T b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> a / gcd(a, b) * b;</div><div class="line">&#125;</div><div class="line"><span class="comment">// find (x, y) s.t. a x + b y = gcd(a, b) = d</span></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">exgcd</span><span class="params">(T a, T b, T &amp;x, T &amp;y)</span> </span>&#123;</div><div class="line">    T d = a;</div><div class="line">    <span class="keyword">if</span> (b) &#123;</div><div class="line">        d = exgcd(b, a % b, y, x);</div><div class="line">        y -= a / b * x;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        x = <span class="number">1</span>; y = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> d;</div><div class="line">&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">modular_linear</span><span class="params">(T a, T b, T n)</span> </span>&#123;</div><div class="line">    T d, e, x, y;</div><div class="line">    d = exgcd(a, n, x, y);</div><div class="line">    <span class="keyword">if</span> (b % d)</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    e = x * (b / d) % n + n;</div><div class="line">    <span class="keyword">return</span> e % (n / d);</div><div class="line">&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">mod_mult</span><span class="params">(T a, T b, T mod)</span> </span>&#123;</div><div class="line">  T res = <span class="number">0</span>;</div><div class="line">  <span class="keyword">while</span> (b) &#123;</div><div class="line">    <span class="keyword">if</span> (b &amp; <span class="number">1</span>) &#123;</div><div class="line">        res = (res + a) % mod;</div><div class="line">        <span class="comment">// res += a;</span></div><div class="line">        <span class="comment">// if (res &gt;= mod) res -= mod;</span></div><div class="line">    &#125;</div><div class="line">    a = (a + a) % mod;</div><div class="line">    <span class="comment">// a &lt;&lt;= 1;</span></div><div class="line">    <span class="comment">// if (a &gt;= mod) a -= mod;</span></div><div class="line">    b &gt;&gt;= <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">mod_pow</span><span class="params">(T x, T n, T mod)</span> </span>&#123;</div><div class="line">    T res = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (n) &#123;</div><div class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) res = mod_mult(res, x, mod);</div><div class="line">        x = mod_mult(x, x, mod);</div><div class="line">        n &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">    <span class="comment">// return b ? mod_pow(a * a % mod, b &gt;&gt; 1, mod) * (b &amp; 1 ? a : 1) % mod : 1;</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="function">T <span class="title">mod_inverse</span><span class="params">(T a, T m)</span> </span>&#123;</div><div class="line">    T x, y;</div><div class="line">    exgcd(a, m, x, y);</div><div class="line">    <span class="keyword">return</span> (m + x % m) % m;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 线性求逆元 小心乘法溢出？</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_inverse</span><span class="params">()</span> </span>&#123;</div><div class="line">    inv[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAX_N; i++)</div><div class="line">        inv[i] = (MOD - (MOD / i) * inv[MOD % i] % MOD) % MOD;</div><div class="line">&#125;</div><div class="line"><span class="comment">//A[i] * x % M[i] = B[i];</span></div><div class="line"><span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; linear_congruence(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;A, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;B, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;M) &#123;</div><div class="line">        <span class="comment">// wa 了把中间量开大？* 溢出</span></div><div class="line">        <span class="keyword">int</span> x = <span class="number">0</span>, m = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.size(); i++) &#123;</div><div class="line">                <span class="keyword">int</span> a = A[i] * m, b = B[i] - A[i] * x, d = gcd(M[i], a);</div><div class="line">                <span class="keyword">if</span>(b % d != <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">std</span>::make_pair(<span class="number">0</span>, <span class="number">-1</span>); <span class="comment">// no solutioin</span></div><div class="line">                <span class="keyword">int</span> t = b / d * mod_inverse(a / d, M[i] / d) % (M[i] / d);</div><div class="line">                x = x + m * t;</div><div class="line">                m *= M[i] / d;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (x &lt; m) x += m;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">std</span>::make_pair(x % m, m);</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">CRT</span><span class="params">(<span class="built_in">vector</span>&lt;ll&gt; &amp;a, <span class="built_in">vector</span>&lt;ll&gt; &amp;m)</span> </span>&#123;</div><div class="line">    ll M = <span class="number">1L</span>L, res = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m.size(); ++i)</div><div class="line">        M *= m[i];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m.size(); ++i) &#123;</div><div class="line">        ll Mi, Ti;</div><div class="line">        Mi = M / m[i]; Ti = mod_inverse(Mi, mi);</div><div class="line">        res = (res + a[i] * (Mi * Ti % M) % M) % M;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"><span class="comment">// only for MOD &lt; 1e6;</span></div><div class="line">ll fact[MOD + <span class="number">10</span>], iact[MOD + <span class="number">10</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">    fact[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MOD; ++i)</div><div class="line">        fact[i] = fact[i - <span class="number">1</span>] * i % MOD;</div><div class="line">    iact[maxn - <span class="number">1</span>] = mod_pow(fact[maxn - <span class="number">1</span>], mod - <span class="number">2</span>, mod);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = maxn - <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i)</div><div class="line">        iact[i] = iact[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % mod;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mod_fact</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> p, <span class="keyword">int</span> &amp;e)</span> </span>&#123;</div><div class="line">    e = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> res = mod_fact(n / p, p, e);</div><div class="line">    e += n / p;</div><div class="line">    <span class="keyword">if</span> (n / p % <span class="number">2</span> != <span class="number">0</span>) <span class="keyword">return</span> res * (p - fact[n % p]) % p;</div><div class="line">    <span class="keyword">return</span> res * fact[n % p] % p;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mod_comb</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">int</span> p)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span> || k &lt; <span class="number">0</span> || n &lt; k) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> e1, e2, e3;</div><div class="line">    <span class="keyword">int</span> a1 = mod_fact(n, p, e1), a2 = mod_fact(k, p, e2), a3 = mod_fact(n - k, p, e3);</div><div class="line">    <span class="keyword">if</span> (e1 &gt; e2 + e3) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span> a1 * mod_inverse(a2 * a3 % p, p) % p;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">lucas</span><span class="params">(ll n, ll k, <span class="keyword">const</span> ll &amp;p)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span> || k &lt; <span class="number">0</span> || n &lt; k) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> lucas(n / p, k / p, p) * mod_comb(n % p, k % p, p) % p;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 矩阵快速幂</span></div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vec;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;vec&gt; mat;</div><div class="line"><span class="function">mat <span class="title">G</span><span class="params">(MAX_N)</span></span>;</div><div class="line"></div><div class="line"><span class="function">mat <span class="title">mat_mul</span><span class="params">(mat &amp;A, mat &amp;B)</span> </span>&#123;</div><div class="line">    mat C(A.size(), vec(B[0].size()));</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.size(); ++i)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; B.size(); ++k)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; B[<span class="number">0</span>].size(); ++j)</div><div class="line">                C[i][j] = (C[i][j] + A[i][k] % MOD * B[k][j] % MOD + MOD) % MOD;</div><div class="line">    <span class="keyword">return</span> C;</div><div class="line">&#125;</div><div class="line"><span class="function">mat <span class="title">mat_pow</span><span class="params">(mat A, ll n)</span> </span>&#123;</div><div class="line">    mat B(A.size(), vec(A.size()));</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.size(); ++i)</div><div class="line">        B[i][i] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (n &gt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) B = mat_mul(B, A);</div><div class="line">        A = mat_mul(A, A);</div><div class="line">        n &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> B;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// prime number</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_prime</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= n; ++i)</div><div class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    <span class="keyword">return</span> n != <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; divisor(<span class="keyword">int</span> n) &#123;</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i * i &lt;= n; ++i) &#123;</div><div class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</div><div class="line">            res.push_back(i);</div><div class="line">            <span class="keyword">if</span> (i != n / i) res.push_back(n / i);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; prime_factor(<span class="keyword">int</span> n) &#123;</div><div class="line">    <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; res;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= n; ++i) &#123;</div><div class="line">        <span class="keyword">while</span> (n % i == <span class="number">0</span>) &#123;</div><div class="line">            ++res[i];</div><div class="line">            n /= i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (n != <span class="number">1</span>) res[n] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> prime[MAX_N];</div><div class="line"><span class="keyword">bool</span> isPrime[MAX_N + <span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">seive</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> p = <span class="number">0</span>;</div><div class="line">    fill(isPrime, isPrime + n + <span class="number">1</span>, <span class="literal">true</span>);</div><div class="line">    isPrime[<span class="number">0</span>] = isPrime[<span class="number">1</span>] = <span class="literal">false</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</div><div class="line">        <span class="keyword">if</span> (isPrime[i]) &#123;</div><div class="line">            prime[p++] = i;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span> * i; j &lt;= n; j += i) isPrime[j] = <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">return</span> p;</div><div class="line">&#125;</div><div class="line"><span class="comment">// the number of prime in [L, r)</span></div><div class="line"><span class="comment">// 对区间 [l, r）内的整数执行筛法，prime[i - l] = true &lt;=&gt; i 是素数</span></div><div class="line"><span class="keyword">bool</span> segPrimeSmall[MAX_L];</div><div class="line"><span class="keyword">bool</span> segPrime[MAX_SQRT_R];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">segment_sieve</span><span class="params">(ll l, ll r)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; (ll)i * i &lt; r; ++i) segPrimeSmall[i] = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r - l; ++i) segPrime[i] = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; (ll)i * i &lt; r; ++i) &#123;</div><div class="line">        <span class="keyword">if</span> (segPrimeSmall[i]) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span> * i; (ll)j * j &lt;= r; j += i) segPrimeSmall[j] = <span class="literal">false</span>;</div><div class="line">            <span class="keyword">for</span> (ll j = max(<span class="number">2l</span>l, (l + i - <span class="number">1</span>) / i) * i; j &lt; r; j += i) segPrime[j - l] = <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// Miller_Rabin</span></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(ll a, ll n, ll x, ll t)</span> </span>&#123;</div><div class="line">    ll res = mod_pow(a, x, n);</div><div class="line">    ll last = res;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t; ++i) &#123;</div><div class="line">        res = mod_mult(res, res, n);</div><div class="line">        <span class="keyword">if</span> (res == <span class="number">1</span> &amp;&amp; last != <span class="number">1</span> &amp;&amp; last != n - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        last = res;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (res != <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Miller_Rabin</span><span class="params">(ll n)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (n &lt; MAX_N) <span class="keyword">return</span> isPrime[n]; <span class="comment">// small number may get wrong answer?!</span></div><div class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    <span class="keyword">if</span> (n == <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    <span class="keyword">if</span> ((n &amp; <span class="number">1</span>) == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    ll x = n - <span class="number">1</span>, t = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> ((x &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</div><div class="line">        x &gt;&gt;= <span class="number">1</span>;</div><div class="line">        ++t;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; ++i) &#123;</div><div class="line">        ll a = rand() % (n - <span class="number">1</span>) + <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (check(a, n, x, t))</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">// find factors</span></div><div class="line"><span class="built_in">vector</span>&lt;ll&gt; factor;</div><div class="line"><span class="function">ll <span class="title">Pollard_rho</span><span class="params">(ll x, ll c)</span> </span>&#123;</div><div class="line">    ll i = <span class="number">1</span>, k = <span class="number">2</span>;</div><div class="line">    ll x0 = rand() % x;</div><div class="line">    ll y = x0;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">        ++i;</div><div class="line">        x0 = (mod_mult(x0, x0, x) + c) % x;</div><div class="line">        ll d;</div><div class="line">        <span class="keyword">if</span> (y == x0) d = <span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="keyword">if</span> (y &gt; x0)</div><div class="line">                d = gcd(y - x0, x);</div><div class="line">            <span class="keyword">else</span> d = gcd(x0 - y, x);</div><div class="line">        <span class="keyword">if</span> (d != <span class="number">1</span> &amp;&amp; d != x) <span class="keyword">return</span> d;</div><div class="line">        <span class="keyword">if</span> (y == x0) <span class="keyword">return</span> x;</div><div class="line">        <span class="keyword">if</span> (i == k) &#123;</div><div class="line">            y = x0;</div><div class="line">            k += k;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">find_factor</span><span class="params">(ll n)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">if</span> (Miller_Rabin(n)) &#123;</div><div class="line">        factor.push_back(n);</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;</div><div class="line">    ll p = n;</div><div class="line">    <span class="keyword">while</span> (p &gt;= n) p = Pollard_rho(p, rand() % (n - <span class="number">1</span>) + <span class="number">1</span>);</div><div class="line">    find_factor(p);</div><div class="line">    find_factor(n / p);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++&gt;</span></span></div><div class="line"><span class="comment">//Meisell-Lehmer</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_N = <span class="number">5e6</span> + <span class="number">2</span>;</div><div class="line"><span class="keyword">bool</span> np[MAX_N];</div><div class="line"><span class="keyword">int</span> prime[MAX_N], pi[MAX_N];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getprime</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">    np[<span class="number">0</span>] = np[<span class="number">1</span>] = <span class="literal">true</span>;</div><div class="line">    pi[<span class="number">0</span>] = pi[<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAX_N; ++i)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(!np[i]) prime[++cnt] = i;</div><div class="line">        pi[i] = cnt;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cnt &amp;&amp; i * prime[j] &lt; MAX_N; ++j)</div><div class="line">        &#123;</div><div class="line">            np[i * prime[j]] = <span class="literal">true</span>;</div><div class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>)   <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> cnt;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">7</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> PM = <span class="number">2</span> * <span class="number">3</span> * <span class="number">5</span> * <span class="number">7</span> * <span class="number">11</span> * <span class="number">13</span> * <span class="number">17</span>;</div><div class="line"><span class="keyword">int</span> phi[PM + <span class="number">1</span>][M + <span class="number">1</span>], sz[M + <span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">    getprime();</div><div class="line">    sz[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= PM; ++i)  phi[i][<span class="number">0</span>] = i;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</div><div class="line">        sz[i] = prime[i] * sz[i - <span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= PM; ++j) phi[j][i] = phi[j][i - <span class="number">1</span>] - phi[j / prime[i]][i - <span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sqrt2</span><span class="params">(ll x)</span> </span>&#123;</div><div class="line">    ll r = (ll)<span class="built_in">sqrt</span>(x - <span class="number">0.1</span>);</div><div class="line">    <span class="keyword">while</span>(r * r &lt;= x)   ++r;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">int</span>(r - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sqrt3</span><span class="params">(ll x)</span> </span>&#123;</div><div class="line">    ll r = (ll)cbrt(x - <span class="number">0.1</span>);</div><div class="line">    <span class="keyword">while</span>(r * r * r &lt;= x)   ++r;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">int</span>(r - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">getphi</span><span class="params">(ll x, <span class="keyword">int</span> s)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">if</span>(s == <span class="number">0</span>)  <span class="keyword">return</span> x;</div><div class="line">    <span class="keyword">if</span>(s &lt;= M)  <span class="keyword">return</span> phi[x % sz[s]][s] + (x / sz[s]) * phi[sz[s]][s];</div><div class="line">    <span class="keyword">if</span>(x &lt;= prime[s]*prime[s])   <span class="keyword">return</span> pi[x] - s + <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(x &lt;= prime[s]*prime[s]*prime[s] &amp;&amp; x &lt; MAX_N) &#123;</div><div class="line">        <span class="keyword">int</span> s2x = pi[sqrt2(x)];</div><div class="line">        ll ans = pi[x] - (s2x + s - <span class="number">2</span>) * (s2x - s + <span class="number">1</span>) / <span class="number">2</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = s + <span class="number">1</span>; i &lt;= s2x; ++i) ans += pi[x / prime[i]];</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> getphi(x, s - <span class="number">1</span>) - getphi(x / prime[s], s - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">getpi</span><span class="params">(ll x)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(x &lt; MAX_N)   <span class="keyword">return</span> pi[x];</div><div class="line">    ll ans = getphi(x, pi[sqrt3(x)]) + pi[sqrt3(x)] - <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = pi[sqrt3(x)] + <span class="number">1</span>, ed = pi[sqrt2(x)]; i &lt;= ed; ++i) ans -= getpi(x / prime[i]) - i + <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">lehmer_pi</span><span class="params">(ll x)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(x &lt; MAX_N)   <span class="keyword">return</span> pi[x];</div><div class="line">    <span class="keyword">int</span> a = (<span class="keyword">int</span>)lehmer_pi(sqrt2(sqrt2(x)));</div><div class="line">    <span class="keyword">int</span> b = (<span class="keyword">int</span>)lehmer_pi(sqrt2(x));</div><div class="line">    <span class="keyword">int</span> c = (<span class="keyword">int</span>)lehmer_pi(sqrt3(x));</div><div class="line">    ll sum = getphi(x, a) +(ll)(b + a - <span class="number">2</span>) * (b - a + <span class="number">1</span>) / <span class="number">2</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = a + <span class="number">1</span>; i &lt;= b; i++) &#123;</div><div class="line">        ll w = x / prime[i];</div><div class="line">        sum -= lehmer_pi(w);</div><div class="line">        <span class="keyword">if</span> (i &gt; c) <span class="keyword">continue</span>;</div><div class="line">        ll lim = lehmer_pi(sqrt2(w));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= lim; j++) sum -= lehmer_pi(w / prime[j]) - (j - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sum;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    init();</div><div class="line">    ll n;</div><div class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n))</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,lehmer_pi(n));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 欧拉函数</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">euler_phi</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> res = n;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= n; ++i) &#123;</div><div class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</div><div class="line">            res = res / i * (i - <span class="number">1</span>);</div><div class="line">            <span class="keyword">for</span> (; n % i == <span class="number">0</span>; n /= i);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (n != <span class="number">1</span>) res = res / n * (n - <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> euler[MAX_N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">euler_phi_sieve</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAX_N; ++i) euler[i] = i;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAX_N; ++i)</div><div class="line">        <span class="keyword">if</span> (euler[i] == i)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; MAX_N; j += i) euler[j] = euler[j] / i * (i - <span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Moebius 如果 <span class="math display">\[F(n) = \sum_{d|n}f(d)\]</span>，则 <span class="math display">\[f(n) = \sum_{d|n}\mu(d)F(\frac{n}{d})\]</span></li>
</ul>
<p>对于 <span class="math inline">\(\mu(d)\)</span> 函数，有如下性质：</p>
<p><span class="math display">\[\sum_{d|n}\mu(d) = \begin{cases}
1&amp; \text{n = 1}\\
0&amp; \text{n &gt; 1}
\end{cases}\]</span></p>
<p><span class="math display">\[\sum_{d|n}\frac{\mu(d)}{d} = \frac{\phi(n)}{n}\]</span></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> mu[MAX_N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">moebius</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>; mu[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span> vis);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAX_N; ++i) &#123;</div><div class="line">        <span class="keyword">if</span> (!vis[i]) &#123;</div><div class="line">            prime[cnt++] = i;</div><div class="line">            mu[i] = <span class="number">-1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt &amp;&amp; i * prime[j] &lt; MAX_N; ++j) &#123;</div><div class="line">            vis[i * prime[j]] = <span class="literal">true</span>;</div><div class="line">            <span class="keyword">if</span> (i % prime[j])</div><div class="line">                mu[i * prime[j]] = -mu[i];</div><div class="line">            <span class="keyword">else</span></div><div class="line">                mu[i * prime[j]] = <span class="number">0</span>, <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; moebius(<span class="keyword">int</span> n) &#123;</div><div class="line">    <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; res;</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; primes;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= n; ++i) &#123;</div><div class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</div><div class="line">            primes.push_back(i);</div><div class="line">            <span class="keyword">while</span> (n % i == <span class="number">0</span>) n /= i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (n != <span class="number">1</span>) primes.push_back(n);</div><div class="line"></div><div class="line">    <span class="keyword">int</span> m = primes.size();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; m); ++i) &#123;</div><div class="line">        <span class="keyword">int</span> mu = <span class="number">1</span>, d = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</div><div class="line">            <span class="keyword">if</span> (i &gt;&gt; j &amp; <span class="number">1</span>) &#123;</div><div class="line">                mu *= <span class="number">-1</span>;</div><div class="line">                d *= primes[j];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        res[d] = mu;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Guass_jordan</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; vec;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;vec&gt; mat;</div><div class="line"></div><div class="line"><span class="function">vec <span class="title">gauss_joedan</span><span class="params">(<span class="keyword">const</span> mat &amp;A, <span class="keyword">const</span> vec&amp; b)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n = A.size();</div><div class="line">    mat B(n, vec(n + 1));</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) B[i][j] = A[i][j];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) B[i][n] = b[i];</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">        <span class="keyword">int</span> pivot = i;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; n; ++j)</div><div class="line">            <span class="keyword">if</span> (<span class="built_in">abs</span>(B[j][i]) &gt; <span class="built_in">abs</span>(B[pivot][i])) pivot = j;</div><div class="line">        <span class="keyword">if</span> (i != pivot) swap(B[i], B[pivot]);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (<span class="built_in">abs</span>(B[i][i]) &lt; eps) <span class="keyword">return</span> vec();</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n; ++j) B[i][j] /= B[i][i];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) <span class="keyword">if</span> (i != j)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = i + <span class="number">1</span>; k &lt;= n; ++k) B[j][k] -= B[j][i] * B[i][k];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function">vec <span class="title">x</span><span class="params">(n)</span></span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) x[i] = B[i][n];</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">vec <span class="title">gauss_joedan_xor</span><span class="params">(<span class="keyword">const</span> mat&amp; A, <span class="keyword">const</span> vec&amp; b)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n = A.size();</div><div class="line">    mat B(n, vec(n + 1));</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) B[i][j] = A[i][j];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) B[i][n] = b[i];</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">        <span class="keyword">int</span> pivot = i;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; n; ++j)</div><div class="line">            <span class="keyword">if</span> (B[j][i]) &#123;</div><div class="line">                pivot = j;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">if</span> (pivot != i) swap(B[i], B[pivot]);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) <span class="keyword">if</span> (i != j &amp;&amp; B[j][i])</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = i + <span class="number">1</span>; k &lt;= n; ++k) B[j][k] ^= B[i][k];</div><div class="line">            &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function">vec <span class="title">x</span><span class="params">(n)</span></span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) x[i] = B[i][n];</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="string">String</h2>
<ol style="list-style-type: decimal">
<li>Hash</li>
<li>KMP</li>
<li>Extend KMP</li>
<li>trie树 poj2001 2503 3630 1056 hdu 1075 1251 1247 1298 1671</li>
<li>Manacher 算法</li>
<li>AC自动机</li>
<li>后缀数组</li>
<li>后缀树</li>
<li>后缀自动机</li>
<li>回文自动机</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 最小最大表示法：</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getMinString</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> len = (<span class="keyword">int</span>)s.length();</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>, k = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(i &lt; len &amp;&amp; j &lt; len &amp;&amp; k &lt; len) &#123;</div><div class="line">        <span class="keyword">int</span> t = s[(i + k) % len] - s[(j + k) % len];</div><div class="line">        <span class="keyword">if</span>(t == <span class="number">0</span>) k++;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span>(t &gt; <span class="number">0</span>) i += k + <span class="number">1</span>;<span class="comment">//getMaxString: t &lt; 0</span></div><div class="line">            <span class="keyword">else</span> j += k + <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span>(i == j) j++;</div><div class="line">            k = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> min(i, j);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// KMP</span></div><div class="line"><span class="keyword">int</span> nxt[MAX_N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNext</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;str)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> len = str.length();</div><div class="line">    <span class="keyword">int</span> j = <span class="number">0</span>, k;</div><div class="line">    k = nxt[<span class="number">0</span>] = <span class="number">-1</span>;</div><div class="line">    <span class="keyword">while</span> (j &lt; len) &#123;</div><div class="line">        <span class="keyword">if</span> (k == <span class="number">-1</span> || str[j] == str[k])</div><div class="line">            nxt[++j] = ++k;</div><div class="line">        <span class="keyword">else</span> k = nxt[k];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">kmp</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;tar, <span class="keyword">const</span> <span class="built_in">string</span> &amp;pat)</span> </span>&#123;</div><div class="line">    getNext(pat);</div><div class="line">    <span class="keyword">int</span> num, j, k;</div><div class="line">    <span class="keyword">int</span> lenT = tar.length(), lenP = pat.length();</div><div class="line">    num = j = k = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (j &lt; lenT) &#123;</div><div class="line">        <span class="keyword">if</span>(k == <span class="number">-1</span> || tar[j] == pat[k])</div><div class="line">            j++, k++;</div><div class="line">        <span class="keyword">else</span> k = nxt[k];</div><div class="line">        <span class="keyword">if</span>(k == lenP) &#123;</div><div class="line">            <span class="comment">// res = max(res, j - lenP);</span></div><div class="line">            k = nxt[k];</div><div class="line">            ++num;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> num;<span class="comment">//lenP - res - 1;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Suffix Array &amp; LCP Array</span></div><div class="line"><span class="keyword">int</span> n, k;</div><div class="line"><span class="keyword">int</span> lcp[MAX_N], sa[MAX_N];</div><div class="line"><span class="keyword">int</span> rnk[MAX_N], tmp[MAX_N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compare_sa</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (rnk[i] != rnk[j]) <span class="keyword">return</span> rnk[i] &lt; rnk[j];</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">int</span> ri = i + k &lt;= n? rnk[i + k] : <span class="number">-1</span>;</div><div class="line">        <span class="keyword">int</span> rj = j + k &lt;= n? rnk[j + k] : <span class="number">-1</span>;</div><div class="line">        <span class="keyword">return</span> ri &lt; rj;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_sa</span><span class="params">(<span class="built_in">string</span> &amp;S, <span class="keyword">int</span> *sa)</span> </span>&#123;</div><div class="line">    n = S.length();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) &#123;</div><div class="line">        sa[i] = i;</div><div class="line">        rnk[i] = i &lt; n? S[i] : <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (k = <span class="number">1</span>; k &lt;= n; k *= <span class="number">2</span>) &#123;</div><div class="line">        sort(sa, sa + n + <span class="number">1</span>, compare_sa);</div><div class="line">        tmp[sa[<span class="number">0</span>]] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">            tmp[sa[i]] = tmp[sa[i - <span class="number">1</span>]] + (compare_sa(sa[i - <span class="number">1</span>], sa[i]) ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">        <span class="built_in">memcpy</span>(rnk, tmp, <span class="keyword">sizeof</span>(<span class="keyword">int</span>) * (n + <span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">construct_lcp</span><span class="params">(<span class="built_in">string</span> &amp;S, <span class="keyword">int</span> *sa, <span class="keyword">int</span> *lcp)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n = S.length();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) rnk[sa[i]] = i;</div><div class="line">    <span class="keyword">int</span> h = <span class="number">0</span>;</div><div class="line">    lcp[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">        <span class="keyword">int</span> j = sa[rnk[i] - <span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span> (h &gt; <span class="number">0</span>) h--;</div><div class="line">        <span class="keyword">for</span> (; j + h &lt; n &amp;&amp; i + h &lt; n; h++)</div><div class="line">            <span class="keyword">if</span> (S[j + h] != S[i + h]) <span class="keyword">break</span>;</div><div class="line">        lcp[rnk[i] - <span class="number">1</span>] = h;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// AC 自动机</span></div><div class="line"><span class="keyword">int</span> ans[MAX_N], d[MAX_N];</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Trie</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> nxt[MAX_N][<span class="number">26</span>], fail[MAX_N], end[MAX_N];</div><div class="line">    <span class="keyword">int</span> root, L;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">newnode</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</div><div class="line">            nxt[L][i] = <span class="number">-1</span>;</div><div class="line">        end[L++] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> L<span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">        L = <span class="number">0</span>;</div><div class="line">        root = newnode();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> buf[])</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> len = <span class="built_in">strlen</span>(buf);</div><div class="line">        <span class="keyword">int</span> now = root;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">            <span class="keyword">if</span>(nxt[now][buf[i]-<span class="string">'a'</span>] == <span class="number">-1</span>)</div><div class="line">                nxt[now][buf[i]-<span class="string">'a'</span>] = newnode();</div><div class="line">            now = nxt[now][buf[i]-<span class="string">'a'</span>];</div><div class="line">        &#125;</div><div class="line">        end[now] = <span class="number">1</span>;</div><div class="line">        d[now] = len;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</div><div class="line">        fail[root] = root;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</div><div class="line">            <span class="keyword">if</span>(nxt[root][i] == <span class="number">-1</span>)</div><div class="line">                nxt[root][i] = root;</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                fail[nxt[root][i]] = root;</div><div class="line">                Q.push(nxt[root][i]);</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">while</span>( !Q.empty() ) &#123;</div><div class="line">            <span class="keyword">int</span> now = Q.front(); Q.pop();</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</div><div class="line">                <span class="keyword">if</span>(nxt[now][i] == <span class="number">-1</span>)</div><div class="line">                    nxt[now][i] = nxt[fail[now]][i];</div><div class="line">                <span class="keyword">else</span> &#123;</div><div class="line">                    fail[nxt[now][i]] = nxt[fail[now]][i];</div><div class="line">                    Q.push(nxt[now][i]);</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">char</span> buf[])</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> cur = root;</div><div class="line">        <span class="keyword">int</span> len = <span class="built_in">strlen</span>(buf);</div><div class="line">        <span class="keyword">int</span> index;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</div><div class="line">            <span class="keyword">if</span>(buf[i] &gt;= <span class="string">'A'</span> &amp;&amp; buf[i] &lt;= <span class="string">'Z'</span>)</div><div class="line">                index = buf[i] - <span class="string">'A'</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(buf[i] &gt;= <span class="string">'a'</span> &amp;&amp; buf[i] &lt;= <span class="string">'z'</span>)</div><div class="line">                index = buf[i] - <span class="string">'a'</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">continue</span>;</div><div class="line">            cur = nxt[cur][index];</div><div class="line">            <span class="keyword">int</span> x = cur;</div><div class="line">            <span class="keyword">while</span>(x != root) &#123;</div><div class="line">                <span class="keyword">if</span>(end[x]) &#123;</div><div class="line">                    ans[i + <span class="number">1</span>] -= <span class="number">1</span>;</div><div class="line">                    ans[i - d[x] + <span class="number">1</span>] += <span class="number">1</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">                x = fail[x];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Trie ac;</div></pre></td></tr></table></figure>
<hr>
<h2 id="others">Others</h2>
<h3 id="divide-and-conquer-tree">Divide-and-Conquer Tree</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//uva 12161</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> to, damage, length, next;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">int</span> G[MAX_N], En, N, M, T;</div><div class="line">edge E[MAX_N * <span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_edge</span><span class="params">(<span class="keyword">int</span> from, <span class="keyword">int</span> to, <span class="keyword">int</span> damage, <span class="keyword">int</span> length)</span> </span>&#123;</div><div class="line">    edge e = &#123;to, damage, length, G[from]&#125;;</div><div class="line">    E[En] = e;</div><div class="line">    G[from] = En++;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> ans, subtree_size[MAX_N];</div><div class="line"><span class="keyword">bool</span> flag[MAX_N];</div><div class="line"></div><div class="line"><span class="keyword">int</span> s, t;</div><div class="line">Pii ds[MAX_N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">compute_subtree_size</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> p)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> c = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = G[v]; ~j; j = E[j].next) &#123;</div><div class="line">        <span class="keyword">int</span> w = E[j].to;</div><div class="line">        <span class="keyword">if</span> (w == p || flag[w]) <span class="keyword">continue</span>;</div><div class="line">        c += compute_subtree_size(w, v);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> subtree_size[v] = c;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Pii <span class="title">search_centroid</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> p, <span class="keyword">int</span> t)</span> </span>&#123;</div><div class="line">    Pii res = Pii(INT_MAX, <span class="number">-1</span>);</div><div class="line">    <span class="keyword">int</span> s = <span class="number">1</span>, m = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = G[v]; ~j; j = E[j].next) &#123;</div><div class="line">        <span class="keyword">int</span> w = E[j].to;</div><div class="line">        <span class="keyword">if</span> (w == p || flag[w]) <span class="keyword">continue</span>;</div><div class="line">        res = min(res, search_centroid(w, v, t));</div><div class="line">        m = max(subtree_size[w], m);</div><div class="line">        s += subtree_size[w];</div><div class="line">    &#125;</div><div class="line">    m = max(m, t - s);</div><div class="line">    res = min(res, Pii(m, v));</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">enumrate_path</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> p, <span class="keyword">int</span> damage, <span class="keyword">int</span> length)</span> </span>&#123;</div><div class="line">    ds[t++] = Pii(damage, length);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = G[v]; ~j; j = E[j].next) &#123;</div><div class="line">        <span class="keyword">int</span> w = E[j].to;</div><div class="line">        <span class="keyword">if</span> (w == p || flag[w]) <span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span> (damage + E[j].damage &lt;= M) &#123;</div><div class="line">            enumrate_path(w, v, damage + E[j].damage, length + E[j].length);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove_useless</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> &amp;t)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (s == t) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> tt;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = tt = s + <span class="number">1</span>; i &lt; t; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (ds[i].first == ds[tt - <span class="number">1</span>].first) <span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span> (ds[i].second &lt;= ds[tt - <span class="number">1</span>].second) <span class="keyword">continue</span>;</div><div class="line">        ds[tt++] = ds[i];</div><div class="line">    &#125;</div><div class="line">    t = tt;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_sub_problem</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    compute_subtree_size(v, <span class="number">-1</span>);</div><div class="line">    <span class="keyword">int</span> c = search_centroid(v, <span class="number">-1</span>, subtree_size[v]).second;</div><div class="line">    flag[c] = <span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = G[c]; ~j; j = E[j].next) &#123;</div><div class="line">        <span class="keyword">if</span> (flag[E[j].to]) <span class="keyword">continue</span>;</div><div class="line">        solve_sub_problem(E[j].to);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    s = t = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = G[c]; ~j; j = E[j].next) &#123;</div><div class="line">        <span class="keyword">int</span> w = E[j].to;</div><div class="line">        <span class="keyword">if</span> (flag[w]) <span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span> (E[j].damage &lt;= M)</div><div class="line">            enumrate_path(w, v, E[j].damage, E[j].length);</div><div class="line">        <span class="keyword">if</span> (s &gt; <span class="number">0</span>) &#123;</div><div class="line">            sort(ds + s, ds + t);</div><div class="line">            remove_useless(s, t);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>, r = t - <span class="number">1</span>; l &lt; s &amp;&amp; r &gt;= s; l++) &#123;</div><div class="line">                <span class="keyword">while</span> (r &gt;= s &amp;&amp; ds[l].first + ds[r].first &gt; M) r--;</div><div class="line">                <span class="keyword">if</span> (r &gt;= s)</div><div class="line">                    ans = max(ans, ds[l].second + ds[r].second);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        sort(ds, ds + t);</div><div class="line">        remove_useless(<span class="number">0</span>, t);</div><div class="line">        s = t;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    flag[c] = <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
	
		
			
		
	
		
			
			
		
	
		
	
	
	
		<li class="prev"><a href="/ACM/skill-tree/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next disabled"><a>next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
  &copy; 2017 Tianshu Wang
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/">Wixo</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.tableofcontents.min.js"></script>
<script src="/js/tocgenerator.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>
